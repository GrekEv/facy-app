# üîß –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ ERR_CONNECTION_REFUSED –¥–ª—è onlyface.art

## –ü—Ä–æ–±–ª–µ–º–∞
DNS –∑–∞–ø–∏—Å–∏ –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã –ø—Ä–∞–≤–∏–ª—å–Ω–æ, –Ω–æ —Å–∞–π—Ç –Ω–µ –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è (ERR_CONNECTION_REFUSED).

## ‚úÖ –†–µ—à–µ–Ω–∏–µ: –ü—Ä–æ–≤–µ—Ä–∫–∞ –≥—Ä—É–ø–ø –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ Yandex Cloud

### –®–∞–≥ 1: –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –≥—Ä—É–ø–ø—ã –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

**–í –∫–æ–Ω—Å–æ–ª–∏ –Ø–Ω–¥–µ–∫—Å.–û–±–ª–∞–∫–∞:**

1. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ **"Virtual Private Cloud"** ‚Üí **"–ì—Ä—É–ø–ø—ã –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏"**
2. –ù–∞–π–¥–∏—Ç–µ –≥—Ä—É–ø–ø—É –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏, —Å–≤—è–∑–∞–Ω–Ω—É—é —Å –≤–∞—à–µ–π –í–ú (–æ–±—ã—á–Ω–æ `default-sg-...`)
3. –û—Ç–∫—Ä–æ–π—Ç–µ –≥—Ä—É–ø–ø—É –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
4. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –Ω–∞ –≤–∫–ª–∞–¥–∫—É **"–ü—Ä–∞–≤–∏–ª–∞"**

### –®–∞–≥ 2: –î–æ–±–∞–≤—å—Ç–µ –ø—Ä–∞–≤–∏–ª–∞ –¥–ª—è –ø–æ—Ä—Ç–æ–≤ 80 –∏ 443

**–£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –µ—Å—Ç—å —Å–ª–µ–¥—É—é—â–∏–µ –ø—Ä–∞–≤–∏–ª–∞:**

#### –ü—Ä–∞–≤–∏–ª–æ 1: HTTP (–ø–æ—Ä—Ç 80)
- **–ù–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ:** –í—Ö–æ–¥—è—â–∏–π —Ç—Ä–∞—Ñ–∏–∫
- **–ü—Ä–æ—Ç–æ–∫–æ–ª:** TCP
- **–ü–æ—Ä—Ç:** 80
- **–ò—Å—Ç–æ—á–Ω–∏–∫:** CIDR `0.0.0.0/0` (–∏–ª–∏ –≤–∞—à IP –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏)
- **–û–ø–∏—Å–∞–Ω–∏–µ:** HTTP –¥–æ—Å—Ç—É–ø

#### –ü—Ä–∞–≤–∏–ª–æ 2: HTTPS (–ø–æ—Ä—Ç 443)
- **–ù–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ:** –í—Ö–æ–¥—è—â–∏–π —Ç—Ä–∞—Ñ–∏–∫
- **–ü—Ä–æ—Ç–æ–∫–æ–ª:** TCP
- **–ü–æ—Ä—Ç:** 443
- **–ò—Å—Ç–æ—á–Ω–∏–∫:** CIDR `0.0.0.0/0` (–∏–ª–∏ –≤–∞—à IP –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏)
- **–û–ø–∏—Å–∞–Ω–∏–µ:** HTTPS –¥–æ—Å—Ç—É–ø

**–ï—Å–ª–∏ –ø—Ä–∞–≤–∏–ª –Ω–µ—Ç - –¥–æ–±–∞–≤—å—Ç–µ –∏—Ö!**

### –®–∞–≥ 3: –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ

**–ü–æ–¥–∫–ª—é—á–∏—Ç–µ—Å—å –∫ —Å–µ—Ä–≤–µ—Ä—É –∏ –≤—ã–ø–æ–ª–Ω–∏—Ç–µ:**

```bash
ssh ubuntu@158.160.96.182

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ Nginx
sudo systemctl status nginx

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ—Ä—Ç–æ–≤
sudo netstat -tlnp | grep -E ':(80|443)'

# –ü—Ä–æ–≤–µ—Ä–∫–∞ firewall
sudo ufw status

# –ï—Å–ª–∏ firewall –∞–∫—Ç–∏–≤–µ–Ω, —Ä–∞–∑—Ä–µ—à–∏—Ç–µ –ø–æ—Ä—Ç—ã:
sudo ufw allow 80/tcp
sudo ufw allow 443/tcp
```

### –®–∞–≥ 4: –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ Nginx

```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
sudo nginx -t

# –ü—Ä–æ—Å–º–æ—Ç—Ä –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
sudo cat /etc/nginx/sites-available/facy | head -20

# –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ Nginx
sudo systemctl restart nginx
```

### –®–∞–≥ 5: –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç—ã –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ –ª–æ–∫–∞–ª—å–Ω–æ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ
curl http://localhost:8000/health

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —á–µ—Ä–µ–∑ Nginx
curl http://localhost/health
curl https://localhost/health
```

## üîç –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞

### –ü—Ä–æ–≤–µ—Ä–∫–∞ DNS —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω–µ–Ω–∏—è

```bash
# –° –≤–∞—à–µ–≥–æ –∫–æ–º–ø—å—é—Ç–µ—Ä–∞
dig onlyface.art +short
# –î–æ–ª–∂–Ω–æ –≤–µ—Ä–Ω—É—Ç—å—Å—è: 158.160.96.182

nslookup onlyface.art
# –î–æ–ª–∂–µ–Ω –ø–æ–∫–∞–∑–∞—Ç—å: 158.160.96.182
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ –ø–æ—Ä—Ç–æ–≤

```bash
# –° –≤–∞—à–µ–≥–æ –∫–æ–º–ø—å—é—Ç–µ—Ä–∞
telnet 158.160.96.182 80
telnet 158.160.96.182 443

# –ò–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –æ–Ω–ª–∞–π–Ω —Å–µ—Ä–≤–∏—Å—ã:
# https://www.yougetsignal.com/tools/open-ports/
# –í–≤–µ–¥–∏—Ç–µ IP: 158.160.96.182 –∏ –ø–æ—Ä—Ç—ã: 80, 443
```

## ‚ö†Ô∏è –ß–∞—Å—Ç—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

### –ü—Ä–æ–±–ª–µ–º–∞ 1: –ü–æ—Ä—Ç—ã –∑–∞–∫—Ä—ã—Ç—ã –≤ –≥—Ä—É–ø–ø–∞—Ö –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

**–†–µ—à–µ–Ω–∏–µ:** –î–æ–±–∞–≤—å—Ç–µ –ø—Ä–∞–≤–∏–ª–∞ –¥–ª—è –ø–æ—Ä—Ç–æ–≤ 80 –∏ 443 –≤ –≥—Ä—É–ø–ø–∞—Ö –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ Yandex Cloud.

### –ü—Ä–æ–±–ª–µ–º–∞ 2: Firewall –±–ª–æ–∫–∏—Ä—É–µ—Ç –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è

**–†–µ—à–µ–Ω–∏–µ:**
```bash
sudo ufw allow 80/tcp
sudo ufw allow 443/tcp
sudo ufw reload
```

### –ü—Ä–æ–±–ª–µ–º–∞ 3: Nginx –Ω–µ –∑–∞–ø—É—â–µ–Ω

**–†–µ—à–µ–Ω–∏–µ:**
```bash
sudo systemctl start nginx
sudo systemctl enable nginx
```

### –ü—Ä–æ–±–ª–µ–º–∞ 4: DNS –µ—â–µ –Ω–µ —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω–∏–ª—Å—è

**–†–µ—à–µ–Ω–∏–µ:** –ü–æ–¥–æ–∂–¥–∏—Ç–µ 5-15 –º–∏–Ω—É—Ç –ø–æ—Å–ª–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ DNS –∑–∞–ø–∏—Å–µ–π.

## ‚úÖ –ë—ã—Å—Ç—Ä–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –≤—Å–µ–≥–æ

**–í—ã–ø–æ–ª–Ω–∏—Ç–µ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ:**

```bash
#!/bin/bash
echo "=== –ü—Ä–æ–≤–µ—Ä–∫–∞ Nginx ==="
sudo systemctl status nginx --no-pager | head -5

echo ""
echo "=== –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ—Ä—Ç–æ–≤ ==="
sudo netstat -tlnp | grep -E ':(80|443)'

echo ""
echo "=== –ü—Ä–æ–≤–µ—Ä–∫–∞ Firewall ==="
sudo ufw status

echo ""
echo "=== –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è ==="
curl -s http://localhost:8000/health

echo ""
echo "=== –ü—Ä–æ–≤–µ—Ä–∫–∞ —á–µ—Ä–µ–∑ Nginx ==="
curl -s http://localhost/health
```

## üìù –ü–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è

–ü–æ—Å–ª–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –ø—Ä–∞–≤–∏–ª –≤ –≥—Ä—É–ø–ø—ã –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏:

1. –ü–æ–¥–æ–∂–¥–∏—Ç–µ 1-2 –º–∏–Ω—É—Ç—ã
2. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –æ—Ç–∫—Ä—ã—Ç—å `https://onlyface.art` –≤ –±—Ä–∞—É–∑–µ—Ä–µ
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ: `curl https://onlyface.art/health`

–ï—Å–ª–∏ –≤—Å–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–æ –ø—Ä–∞–≤–∏–ª—å–Ω–æ, —Å–∞–π—Ç –¥–æ–ª–∂–µ–Ω –æ—Ç–∫—Ä—ã—Ç—å—Å—è!

