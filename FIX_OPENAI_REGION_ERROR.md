# Решение проблемы: OpenAI API недоступен в регионе

## ⚠️ Важно: Пользователю НЕ нужен VPN!

**Прокси настраивается на сервере**, а не на устройстве пользователя. Пользователь просто отправляет запрос на ваш сервер, а сервер использует прокси для доступа к OpenAI API.

## Проблема

Ошибка: `"unsupported_country_region_territory"` - OpenAI API недоступен в регионе сервера.

## Решения

### Вариант 1: Настроить прокси на сервере (рекомендуется)

Настройте прокси в `.env` файле на вашем сервере:

```bash
# В .env файле на сервере добавьте:
OPENAI_API_KEY=sk-ваш_ключ_openai
IMAGE_GENERATION_PROVIDER=openai
OPENAI_PROXY=http://proxy-server.com:8080
```

Прокси уже настроен в коде автоматически - просто укажите `OPENAI_PROXY` в `.env`.

**Как это работает:**
1. Пользователь отправляет запрос на ваш сервер (без VPN)
2. Ваш сервер использует прокси для запроса к OpenAI API
3. Пользователь получает результат через ваш сервер

**Пользователю не нужно ничего настраивать!**

### Вариант 2: Использовать альтернативный провайдер

#### Настройка FFans API

1. Зарегистрируйтесь на https://ffans.ai
2. Получите API ключ
3. Добавьте в `.env`:
```bash
FFANS_API_KEY=ваш_ключ_ffans
IMAGE_GENERATION_PROVIDER=ffans
```

#### Настройка Replicate API

1. Зарегистрируйтесь на https://replicate.com
2. Получите API токен
3. Добавьте в `.env`:
```bash
REPLICATE_API_KEY=ваш_ключ_replicate
IMAGE_GENERATION_PROVIDER=replicate
```

#### Настройка Leonardo.AI

1. Зарегистрируйтесь на https://leonardo.ai
2. Получите API ключ
3. Добавьте в `.env`:
```bash
LEONARDO_API_KEY=ваш_ключ_leonardo
IMAGE_GENERATION_PROVIDER=leonardo
```

### Вариант 3: Запуск через прокси-сервер

Если у вас есть прокси-сервер в доступном регионе:

1. Настройте прокси в коде
2. Или используйте сервис типа Cloudflare Workers как прокси

## Рекомендация

Для работы в России/СНГ лучше использовать:
- **FFans API** - работает в России
- **Replicate** - работает через API
- **Leonardo.AI** - альтернатива OpenAI

## Проверка работы

После настройки альтернативного провайдера запустите тест:

```bash
python3 test_image_generation.py
```

Должно работать без ошибок региона.

