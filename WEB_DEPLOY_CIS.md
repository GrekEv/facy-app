# ðŸŒ Ð Ð°Ð·Ð²ÐµÑ€Ñ‚Ñ‹Ð²Ð°Ð½Ð¸Ðµ Ð²ÐµÐ±-Ð¿Ñ€Ð¸Ð»Ð¾Ð¶ÐµÐ½Ð¸Ñ Ð´Ð»Ñ Ð Ð¤ Ð¸ Ð Ð‘

## ðŸŽ¯ Ð ÐµÑˆÐµÐ½Ð¸Ñ Ð´Ð»Ñ Ð Ð¾ÑÑÐ¸Ð¸ Ð¸ Ð‘ÐµÐ»Ð°Ñ€ÑƒÑÐ¸

### Ð’Ð°Ñ€Ð¸Ð°Ð½Ñ‚ 1: Ð¯Ð½Ð´ÐµÐºÑ.ÐžÐ±Ð»Ð°ÐºÐ¾ + Ð Ð¾ÑÑÐ¸Ð¹ÑÐºÐ¸Ð¹ Ð´Ð¾Ð¼ÐµÐ½ (Ñ€ÐµÐºÐ¾Ð¼ÐµÐ½Ð´ÑƒÐµÑ‚ÑÑ) â­

**ÐŸÑ€ÐµÐ¸Ð¼ÑƒÑ‰ÐµÑÑ‚Ð²Ð°:**
- âœ… ÐŸÐ¾Ð»Ð½Ð¾ÑÑ‚ÑŒÑŽ Ð´Ð¾ÑÑ‚ÑƒÐ¿ÐµÐ½ Ð² Ð Ð¤ Ð¸ Ð Ð‘
- âœ… SSL Ñ‡ÐµÑ€ÐµÐ· Let's Encrypt (Ñ€Ð°Ð±Ð¾Ñ‚Ð°ÐµÑ‚ Ð² Ð Ð¤)
- âœ… Ð‘Ñ‹ÑÑ‚Ñ€Ð°Ñ ÑÐºÐ¾Ñ€Ð¾ÑÑ‚ÑŒ
- âœ… ÐÐµÑ‚ Ð¿Ñ€Ð¾Ð±Ð»ÐµÐ¼ Ñ Ð±Ð»Ð¾ÐºÐ¸Ñ€Ð¾Ð²ÐºÐ°Ð¼Ð¸

**Ð§Ñ‚Ð¾ Ð½ÑƒÐ¶Ð½Ð¾:**
1. Ð”Ð¾Ð¼ÐµÐ½ Ð½Ð° `.ru`, `.Ñ€Ñ„` Ð¸Ð»Ð¸ `.by` (Ñ€ÐµÐ³Ð¸ÑÑ‚Ñ€Ð°Ñ‚Ð¾Ñ€Ñ‹: reg.ru, nic.ru, timeweb.ru)
2. Ð¡ÐµÑ€Ð²ÐµÑ€ Ð½Ð° Ð¯Ð½Ð´ÐµÐºÑ.ÐžÐ±Ð»Ð°ÐºÐµ (ÑƒÐ¶Ðµ ÐµÑÑ‚ÑŒ)
3. SSL Ñ‡ÐµÑ€ÐµÐ· Let's Encrypt (Ð±ÐµÑÐ¿Ð»Ð°Ñ‚Ð½Ð¾)

### Ð’Ð°Ñ€Ð¸Ð°Ð½Ñ‚ 2: Cloudflare (Ð°Ð»ÑŒÑ‚ÐµÑ€Ð½Ð°Ñ‚Ð¸Ð²Ð°)

**âš ï¸ Ð’Ð½Ð¸Ð¼Ð°Ð½Ð¸Ðµ:** Cloudflare Ð¼Ð¾Ð¶ÐµÑ‚ Ð±Ñ‹Ñ‚ÑŒ Ð·Ð°Ð±Ð»Ð¾ÐºÐ¸Ñ€Ð¾Ð²Ð°Ð½ Ð¸Ð»Ð¸ Ð¼ÐµÐ´Ð»ÐµÐ½Ð½Ð¾ Ñ€Ð°Ð±Ð¾Ñ‚Ð°Ñ‚ÑŒ Ð² Ð Ð¤/Ð Ð‘

**Ð•ÑÐ»Ð¸ Ñ…Ð¾Ñ‚Ð¸Ñ‚Ðµ Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÑŒ Cloudflare:**
- âœ… Ð‘ÐµÑÐ¿Ð»Ð°Ñ‚Ð½Ñ‹Ð¹ SSL
- âœ… CDN Ð´Ð»Ñ ÑƒÑÐºÐ¾Ñ€ÐµÐ½Ð¸Ñ
- âš ï¸ ÐœÐ¾Ð¶ÐµÑ‚ Ð±Ñ‹Ñ‚ÑŒ Ð·Ð°Ð±Ð»Ð¾ÐºÐ¸Ñ€Ð¾Ð²Ð°Ð½
- âš ï¸ ÐœÐ¾Ð¶ÐµÑ‚ Ð±Ñ‹Ñ‚ÑŒ Ð¼ÐµÐ´Ð»ÐµÐ½Ð½Ñ‹Ð¼ Ð² Ð Ð¤

## ðŸš€ Ð‘Ñ‹ÑÑ‚Ñ€Ð°Ñ Ð½Ð°ÑÑ‚Ñ€Ð¾Ð¹ÐºÐ° (Ð¯Ð½Ð´ÐµÐºÑ.ÐžÐ±Ð»Ð°ÐºÐ¾ + Ð Ð¾ÑÑÐ¸Ð¹ÑÐºÐ¸Ð¹ Ð´Ð¾Ð¼ÐµÐ½)

### Ð¨Ð°Ð³ 1: Ð ÐµÐ³Ð¸ÑÑ‚Ñ€Ð°Ñ†Ð¸Ñ Ð´Ð¾Ð¼ÐµÐ½Ð°

**Ð ÐµÐºÐ¾Ð¼ÐµÐ½Ð´ÑƒÐµÐ¼Ñ‹Ðµ Ñ€ÐµÐ³Ð¸ÑÑ‚Ñ€Ð°Ñ‚Ð¾Ñ€Ñ‹:**
- **reg.ru** - Ð¾Ñ‚ 99â‚½/Ð³Ð¾Ð´
- **nic.ru** - Ð¾Ñ‚ 199â‚½/Ð³Ð¾Ð´  
- **timeweb.ru** - Ð¾Ñ‚ 149â‚½/Ð³Ð¾Ð´

**Ð’Ñ‹Ð±ÐµÑ€Ð¸Ñ‚Ðµ Ð´Ð¾Ð¼ÐµÐ½:**
- `.ru` - ÐºÐ»Ð°ÑÑÐ¸Ñ‡ÐµÑÐºÐ¸Ð¹ Ð²Ð°Ñ€Ð¸Ð°Ð½Ñ‚
- `.Ñ€Ñ„` - ÐºÐ¸Ñ€Ð¸Ð»Ð»Ð¸Ñ‡ÐµÑÐºÐ¸Ð¹ Ð´Ð¾Ð¼ÐµÐ½
- `.by` - Ð´Ð»Ñ Ð‘ÐµÐ»Ð°Ñ€ÑƒÑÐ¸

### Ð¨Ð°Ð³ 2: ÐÐ°ÑÑ‚Ñ€Ð¾Ð¹ÐºÐ° DNS

**Ð’ Ð¿Ð°Ð½ÐµÐ»Ð¸ Ñ€ÐµÐ³Ð¸ÑÑ‚Ñ€Ð°Ñ‚Ð¾Ñ€Ð° Ð´Ð¾Ð¼ÐµÐ½Ð° Ð´Ð¾Ð±Ð°Ð²ÑŒÑ‚Ðµ A-Ð·Ð°Ð¿Ð¸ÑÑŒ:**

```
Ð¢Ð¸Ð¿: A
Ð˜Ð¼Ñ: @ (Ð¸Ð»Ð¸ www)
Ð—Ð½Ð°Ñ‡ÐµÐ½Ð¸Ðµ: 158.160.96.182
TTL: 3600
```

**Ð˜Ð»Ð¸ Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÐ¹Ñ‚Ðµ Yandex Cloud DNS:**

1. Ð’ ÐºÐ¾Ð½ÑÐ¾Ð»Ð¸ Ð¯Ð½Ð´ÐµÐºÑ.ÐžÐ±Ð»Ð°ÐºÐ°: **Cloud DNS** â†’ **Ð¡Ð¾Ð·Ð´Ð°Ñ‚ÑŒ Ð·Ð¾Ð½Ñƒ**
2. **Ð˜Ð¼Ñ Ð·Ð¾Ð½Ñ‹:** `facy-zone`
3. **Ð”Ð¾Ð¼ÐµÐ½:** `Ð²Ð°Ñˆ-Ð´Ð¾Ð¼ÐµÐ½.ru`
4. **Ð¢Ð¸Ð¿:** ÐŸÑƒÐ±Ð»Ð¸Ñ‡Ð½Ð°Ñ
5. Ð¡ÐºÐ¾Ð¿Ð¸Ñ€ÑƒÐ¹Ñ‚Ðµ NS-ÑÐµÑ€Ð²ÐµÑ€Ñ‹
6. Ð’ Ð¿Ð°Ð½ÐµÐ»Ð¸ Ñ€ÐµÐ³Ð¸ÑÑ‚Ñ€Ð°Ñ‚Ð¾Ñ€Ð° Ð´Ð¾Ð¼ÐµÐ½Ð° ÑƒÐºÐ°Ð¶Ð¸Ñ‚Ðµ ÑÑ‚Ð¸ NS-ÑÐµÑ€Ð²ÐµÑ€Ñ‹
7. Ð’ Ð·Ð¾Ð½Ðµ Cloud DNS ÑÐ¾Ð·Ð´Ð°Ð¹Ñ‚Ðµ A-Ð·Ð°Ð¿Ð¸ÑÑŒ:
   - **Ð˜Ð¼Ñ:** `@`
   - **Ð¢Ð¸Ð¿:** A
   - **Ð—Ð½Ð°Ñ‡ÐµÐ½Ð¸Ðµ:** `158.160.96.182`

### Ð¨Ð°Ð³ 3: Ð£ÑÑ‚Ð°Ð½Ð¾Ð²ÐºÐ° Nginx Ð¸ SSL

**ÐÐ° ÑÐµÑ€Ð²ÐµÑ€Ðµ Ð²Ñ‹Ð¿Ð¾Ð»Ð½Ð¸Ñ‚Ðµ:**

```bash
cd ~/facy-app

# Ð£ÑÑ‚Ð°Ð½Ð¾Ð²ÐºÐ° Nginx
sudo apt update
sudo apt install -y nginx

# Ð¡Ð¾Ð·Ð´Ð°Ð½Ð¸Ðµ ÐºÐ¾Ð½Ñ„Ð¸Ð³ÑƒÑ€Ð°Ñ†Ð¸Ð¸
sudo tee /etc/nginx/sites-available/facy > /dev/null <<'EOF'
server {
    listen 80;
    server_name Ð²Ð°Ñˆ-Ð´Ð¾Ð¼ÐµÐ½.ru www.Ð²Ð°Ñˆ-Ð´Ð¾Ð¼ÐµÐ½.ru;

    client_max_body_size 100M;

    location / {
        proxy_pass http://localhost:8000;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;
        
        proxy_http_version 1.1;
        proxy_set_header Upgrade $http_upgrade;
        proxy_set_header Connection "upgrade";
        
        proxy_connect_timeout 60s;
        proxy_send_timeout 60s;
        proxy_read_timeout 60s;
    }

    location /static/ {
        alias /home/ubuntu/facy-app/static/;
        expires 30d;
        add_header Cache-Control "public, immutable";
    }
    
    location /uploads/ {
        alias /home/ubuntu/facy-app/uploads/;
        expires 7d;
    }
    
    location /generated/ {
        alias /home/ubuntu/facy-app/generated/;
        expires 7d;
    }
}
EOF

# Ð—Ð°Ð¼ÐµÐ½Ð¸Ñ‚Ðµ Ð²Ð°Ñˆ-Ð´Ð¾Ð¼ÐµÐ½.ru Ð½Ð° Ð²Ð°Ñˆ Ð´Ð¾Ð¼ÐµÐ½
sudo sed -i "s/Ð²Ð°Ñˆ-Ð´Ð¾Ð¼ÐµÐ½.ru/Ð’ÐÐ¨_Ð”ÐžÐœÐ•Ð.ru/g" /etc/nginx/sites-available/facy

# ÐÐºÑ‚Ð¸Ð²Ð°Ñ†Ð¸Ñ
sudo ln -sf /etc/nginx/sites-available/facy /etc/nginx/sites-enabled/
sudo rm -f /etc/nginx/sites-enabled/default
sudo nginx -t
sudo systemctl restart nginx
sudo systemctl enable nginx

# Ð£ÑÑ‚Ð°Ð½Ð¾Ð²ÐºÐ° SSL
sudo apt install -y certbot python3-certbot-nginx

# ÐŸÐ¾Ð»ÑƒÑ‡ÐµÐ½Ð¸Ðµ ÑÐµÑ€Ñ‚Ð¸Ñ„Ð¸ÐºÐ°Ñ‚Ð° (Ð·Ð°Ð¼ÐµÐ½Ð¸Ñ‚Ðµ Ð½Ð° Ð²Ð°Ñˆ Ð´Ð¾Ð¼ÐµÐ½)
sudo certbot --nginx -d Ð²Ð°Ñˆ-Ð´Ð¾Ð¼ÐµÐ½.ru -d www.Ð²Ð°Ñˆ-Ð´Ð¾Ð¼ÐµÐ½.ru --non-interactive --agree-tos --email admin@Ð²Ð°Ñˆ-Ð´Ð¾Ð¼ÐµÐ½.ru

# ÐžÐ±Ð½Ð¾Ð²Ð»ÐµÐ½Ð¸Ðµ .env
sed -i "s|WEBAPP_URL=.*|WEBAPP_URL=https://Ð²Ð°Ñˆ-Ð´Ð¾Ð¼ÐµÐ½.ru|g" .env

# ÐŸÐµÑ€ÐµÐ·Ð°Ð¿ÑƒÑÐº Ð¿Ñ€Ð¸Ð»Ð¾Ð¶ÐµÐ½Ð¸Ñ
docker compose -f docker-compose.prod.yml restart
```

### Ð¨Ð°Ð³ 4: ÐÐ°ÑÑ‚Ñ€Ð¾Ð¹ÐºÐ° Telegram Bot

1. ÐžÑ‚ÐºÑ€Ð¾Ð¹Ñ‚Ðµ [@BotFather](https://t.me/BotFather)
2. `/mybots` â†’ Ð²Ñ‹Ð±ÐµÑ€Ð¸Ñ‚Ðµ Ð±Ð¾Ñ‚Ð°
3. **Bot Settings** â†’ **Menu Button**
4. **URL:** `https://Ð²Ð°Ñˆ-Ð´Ð¾Ð¼ÐµÐ½.ru`

## ðŸ”„ ÐÐ»ÑŒÑ‚ÐµÑ€Ð½Ð°Ñ‚Ð¸Ð²Ð°: Cloudflare (ÐµÑÐ»Ð¸ Ð½ÑƒÐ¶Ð½Ð¾)

### ÐÐ°ÑÑ‚Ñ€Ð¾Ð¹ÐºÐ° Cloudflare

**âš ï¸ ÐŸÑ€Ð¾Ð²ÐµÑ€ÑŒÑ‚Ðµ Ð´Ð¾ÑÑ‚ÑƒÐ¿Ð½Ð¾ÑÑ‚ÑŒ Cloudflare Ð² Ð²Ð°ÑˆÐµÐ¼ Ñ€ÐµÐ³Ð¸Ð¾Ð½Ðµ!**

1. **Ð ÐµÐ³Ð¸ÑÑ‚Ñ€Ð°Ñ†Ð¸Ñ Ð½Ð° Cloudflare:**
   - ÐžÑ‚ÐºÑ€Ð¾Ð¹Ñ‚Ðµ https://cloudflare.com
   - Ð—Ð°Ñ€ÐµÐ³Ð¸ÑÑ‚Ñ€Ð¸Ñ€ÑƒÐ¹Ñ‚ÐµÑÑŒ (Ð±ÐµÑÐ¿Ð»Ð°Ñ‚Ð½Ð¾)

2. **Ð”Ð¾Ð±Ð°Ð²Ð»ÐµÐ½Ð¸Ðµ Ð´Ð¾Ð¼ÐµÐ½Ð°:**
   - Ð”Ð¾Ð±Ð°Ð²ÑŒÑ‚Ðµ Ð²Ð°Ñˆ Ð´Ð¾Ð¼ÐµÐ½
   - Cloudflare Ð°Ð²Ñ‚Ð¾Ð¼Ð°Ñ‚Ð¸Ñ‡ÐµÑÐºÐ¸ Ð½Ð°Ð¹Ð´ÐµÑ‚ DNS Ð·Ð°Ð¿Ð¸ÑÐ¸
   - Ð˜Ð·Ð¼ÐµÐ½Ð¸Ñ‚Ðµ NS-ÑÐµÑ€Ð²ÐµÑ€Ñ‹ Ð² Ð¿Ð°Ð½ÐµÐ»Ð¸ Ñ€ÐµÐ³Ð¸ÑÑ‚Ñ€Ð°Ñ‚Ð¾Ñ€Ð° Ð½Ð° Ñ‚Ðµ, Ñ‡Ñ‚Ð¾ Ð´Ð°Ð» Cloudflare

3. **ÐÐ°ÑÑ‚Ñ€Ð¾Ð¹ÐºÐ° DNS Ð² Cloudflare:**
   - Ð”Ð¾Ð±Ð°Ð²ÑŒÑ‚Ðµ A-Ð·Ð°Ð¿Ð¸ÑÑŒ: `@` â†’ `158.160.96.182`
   - Ð”Ð¾Ð±Ð°Ð²ÑŒÑ‚Ðµ A-Ð·Ð°Ð¿Ð¸ÑÑŒ: `www` â†’ `158.160.96.182`

4. **ÐÐ°ÑÑ‚Ñ€Ð¾Ð¹ÐºÐ° SSL:**
   - Ð’ Cloudflare: **SSL/TLS** â†’ **Overview**
   - Ð’Ñ‹Ð±ÐµÑ€Ð¸Ñ‚Ðµ **Flexible** (ÐµÑÐ»Ð¸ Ð½ÐµÑ‚ SSL Ð½Ð° ÑÐµÑ€Ð²ÐµÑ€Ðµ) Ð¸Ð»Ð¸ **Full** (ÐµÑÐ»Ð¸ ÐµÑÑ‚ÑŒ SSL)
   - Cloudflare Ð°Ð²Ñ‚Ð¾Ð¼Ð°Ñ‚Ð¸Ñ‡ÐµÑÐºÐ¸ Ð²Ñ‹Ð´Ð°ÑÑ‚ SSL ÑÐµÑ€Ñ‚Ð¸Ñ„Ð¸ÐºÐ°Ñ‚

5. **ÐÐ°ÑÑ‚Ñ€Ð¾Ð¹ÐºÐ° Ð½Ð° ÑÐµÑ€Ð²ÐµÑ€Ðµ:**
   - Ð•ÑÐ»Ð¸ Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÐµÑ‚Ðµ Cloudflare, Ð¼Ð¾Ð¶Ð½Ð¾ Ð½Ðµ ÑƒÑÑ‚Ð°Ð½Ð°Ð²Ð»Ð¸Ð²Ð°Ñ‚ÑŒ SSL Ð½Ð° ÑÐµÑ€Ð²ÐµÑ€Ðµ
   - Nginx Ð±ÑƒÐ´ÐµÑ‚ Ñ€Ð°Ð±Ð¾Ñ‚Ð°Ñ‚ÑŒ Ð½Ð° HTTP (Ð¿Ð¾Ñ€Ñ‚ 80)
   - Cloudflare Ð±ÑƒÐ´ÐµÑ‚ Ð¿Ñ€Ð¾ÐºÑÐ¸Ñ€Ð¾Ð²Ð°Ñ‚ÑŒ HTTPS

**ÐžÐ±Ð½Ð¾Ð²Ð»ÐµÐ½Ð¸Ðµ .env:**
```bash
WEBAPP_URL=https://Ð²Ð°Ñˆ-Ð´Ð¾Ð¼ÐµÐ½.ru
```

## ðŸ“‹ ÐÐ²Ñ‚Ð¾Ð¼Ð°Ñ‚Ð¸Ñ‡ÐµÑÐºÐ¸Ð¹ ÑÐºÑ€Ð¸Ð¿Ñ‚ Ð´Ð»Ñ Ð Ð¤/Ð Ð‘

Ð¡Ð¾Ð·Ð´Ð°Ð¹Ñ‚Ðµ Ñ„Ð°Ð¹Ð» `setup_web_cis.sh`:

```bash
#!/bin/bash
# Ð¡ÐºÑ€Ð¸Ð¿Ñ‚ Ð½Ð°ÑÑ‚Ñ€Ð¾Ð¹ÐºÐ¸ Ð²ÐµÐ±-Ð¿Ñ€Ð¸Ð»Ð¾Ð¶ÐµÐ½Ð¸Ñ Ð´Ð»Ñ Ð Ð¤/Ð Ð‘

set -e

cd ~/facy-app || exit 1

echo "ðŸŒ ÐÐ°ÑÑ‚Ñ€Ð¾Ð¹ÐºÐ° Ð²ÐµÐ±-Ð¿Ñ€Ð¸Ð»Ð¾Ð¶ÐµÐ½Ð¸Ñ Ð´Ð»Ñ Ð Ð¤/Ð Ð‘"
echo "======================================"
echo ""

# Ð—Ð°Ð¿Ñ€Ð¾Ñ Ð´Ð¾Ð¼ÐµÐ½Ð°
read -p "Ð’Ð²ÐµÐ´Ð¸Ñ‚Ðµ Ð²Ð°Ñˆ Ð´Ð¾Ð¼ÐµÐ½ (Ð½Ð°Ð¿Ñ€Ð¸Ð¼ÐµÑ€: facy-app.ru): " DOMAIN

if [ -z "$DOMAIN" ]; then
    echo "âŒ Ð”Ð¾Ð¼ÐµÐ½ Ð¾Ð±ÑÐ·Ð°Ñ‚ÐµÐ»ÐµÐ½ Ð´Ð»Ñ Telegram Mini App!"
    exit 1
fi

echo ""
echo "ðŸ“¦ Ð£ÑÑ‚Ð°Ð½Ð¾Ð²ÐºÐ° Nginx..."
sudo apt update
sudo apt install -y nginx

echo ""
echo "ðŸ”§ Ð¡Ð¾Ð·Ð´Ð°Ð½Ð¸Ðµ ÐºÐ¾Ð½Ñ„Ð¸Ð³ÑƒÑ€Ð°Ñ†Ð¸Ð¸ Nginx..."

# Ð¡Ð¾Ð·Ð´Ð°ÐµÐ¼ ÐºÐ¾Ð½Ñ„Ð¸Ð³ÑƒÑ€Ð°Ñ†Ð¸ÑŽ
sudo tee /etc/nginx/sites-available/facy > /dev/null <<EOF
server {
    listen 80;
    server_name $DOMAIN www.$DOMAIN;

    client_max_body_size 100M;

    location / {
        proxy_pass http://localhost:8000;
        proxy_set_header Host \$host;
        proxy_set_header X-Real-IP \$remote_addr;
        proxy_set_header X-Forwarded-For \$proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto \$scheme;
        
        proxy_http_version 1.1;
        proxy_set_header Upgrade \$http_upgrade;
        proxy_set_header Connection "upgrade";
    }

    location /static/ {
        alias $(pwd)/static/;
        expires 30d;
    }
    
    location /uploads/ {
        alias $(pwd)/uploads/;
        expires 7d;
    }
    
    location /generated/ {
        alias $(pwd)/generated/;
        expires 7d;
    }
}
EOF

# ÐÐºÑ‚Ð¸Ð²Ð°Ñ†Ð¸Ñ
sudo ln -sf /etc/nginx/sites-available/facy /etc/nginx/sites-enabled/
sudo rm -f /etc/nginx/sites-enabled/default
sudo nginx -t
sudo systemctl restart nginx
sudo systemctl enable nginx

echo ""
echo "ðŸ” Ð£ÑÑ‚Ð°Ð½Ð¾Ð²ÐºÐ° SSL ÑÐµÑ€Ñ‚Ð¸Ñ„Ð¸ÐºÐ°Ñ‚Ð°..."
echo "âš ï¸  Ð£Ð±ÐµÐ´Ð¸Ñ‚ÐµÑÑŒ, Ñ‡Ñ‚Ð¾ DNS Ð·Ð°Ð¿Ð¸ÑÑŒ Ð´Ð»Ñ $DOMAIN ÑƒÐºÐ°Ð·Ñ‹Ð²Ð°ÐµÑ‚ Ð½Ð° 158.160.96.182"
read -p "ÐÐ°Ð¶Ð¼Ð¸Ñ‚Ðµ Enter ÐºÐ¾Ð³Ð´Ð° DNS Ð½Ð°ÑÑ‚Ñ€Ð¾ÐµÐ½..."

sudo apt install -y certbot python3-certbot-nginx
sudo certbot --nginx -d $DOMAIN -d www.$DOMAIN --non-interactive --agree-tos --email admin@$DOMAIN

# ÐžÐ±Ð½Ð¾Ð²Ð»ÐµÐ½Ð¸Ðµ .env
if [ -f .env ]; then
    sed -i "s|WEBAPP_URL=.*|WEBAPP_URL=https://$DOMAIN|g" .env
    echo "âœ… WEBAPP_URL Ð¾Ð±Ð½Ð¾Ð²Ð»ÐµÐ½ Ð² .env"
fi

# ÐÐ°ÑÑ‚Ñ€Ð¾Ð¹ÐºÐ° firewall
sudo ufw allow 22/tcp
sudo ufw allow 80/tcp
sudo ufw allow 443/tcp
sudo ufw --force enable || true

echo ""
echo "âœ… Ð“Ð¾Ñ‚Ð¾Ð²Ð¾!"
echo ""
echo "ðŸ“‹ Ð˜Ð½Ñ„Ð¾Ñ€Ð¼Ð°Ñ†Ð¸Ñ:"
echo "  - HTTPS: https://$DOMAIN"
echo "  - API Health: https://$DOMAIN/health"
echo ""
echo "ðŸ“ Ð¡Ð»ÐµÐ´ÑƒÑŽÑ‰Ð¸Ðµ ÑˆÐ°Ð³Ð¸:"
echo "1. ÐÐ°ÑÑ‚Ñ€Ð¾Ð¹Ñ‚Ðµ Menu Button Ð² BotFather:"
echo "   URL: https://$DOMAIN"
echo ""
echo "2. ÐŸÐµÑ€ÐµÐ·Ð°Ð¿ÑƒÑÑ‚Ð¸Ñ‚Ðµ Ð¿Ñ€Ð¸Ð»Ð¾Ð¶ÐµÐ½Ð¸Ðµ:"
echo "   docker compose -f docker-compose.prod.yml restart"
```

## âœ… ÐŸÑ€Ð¾Ð²ÐµÑ€ÐºÐ° Ñ€Ð°Ð±Ð¾Ñ‚Ñ‹

```bash
# ÐŸÑ€Ð¾Ð²ÐµÑ€ÐºÐ° HTTP
curl http://Ð²Ð°Ñˆ-Ð´Ð¾Ð¼ÐµÐ½.ru/health

# ÐŸÑ€Ð¾Ð²ÐµÑ€ÐºÐ° HTTPS
curl https://Ð²Ð°Ñˆ-Ð´Ð¾Ð¼ÐµÐ½.ru/health

# ÐŸÑ€Ð¾Ð²ÐµÑ€ÐºÐ° Ð² Ð±Ñ€Ð°ÑƒÐ·ÐµÑ€Ðµ
# ÐžÑ‚ÐºÑ€Ð¾Ð¹Ñ‚Ðµ: https://Ð²Ð°Ñˆ-Ð´Ð¾Ð¼ÐµÐ½.ru
```

## ðŸ› Ð ÐµÑˆÐµÐ½Ð¸Ðµ Ð¿Ñ€Ð¾Ð±Ð»ÐµÐ¼

### ÐŸÑ€Ð¾Ð±Ð»ÐµÐ¼Ð°: DNS Ð½Ðµ Ñ€ÐµÐ·Ð¾Ð»Ð²Ð¸Ñ‚ÑÑ

```bash
# ÐŸÑ€Ð¾Ð²ÐµÑ€ÑŒÑ‚Ðµ DNS
dig Ð²Ð°Ñˆ-Ð´Ð¾Ð¼ÐµÐ½.ru
nslookup Ð²Ð°Ñˆ-Ð´Ð¾Ð¼ÐµÐ½.ru

# ÐŸÑ€Ð¾Ð²ÐµÑ€ÑŒÑ‚Ðµ Ð½Ð°ÑÑ‚Ñ€Ð¾Ð¹ÐºÐ¸ DNS Ð² Ð¿Ð°Ð½ÐµÐ»Ð¸ Ñ€ÐµÐ³Ð¸ÑÑ‚Ñ€Ð°Ñ‚Ð¾Ñ€Ð°
```

### ÐŸÑ€Ð¾Ð±Ð»ÐµÐ¼Ð°: SSL Ð½Ðµ ÑƒÑÑ‚Ð°Ð½Ð°Ð²Ð»Ð¸Ð²Ð°ÐµÑ‚ÑÑ

```bash
# ÐŸÑ€Ð¾Ð²ÐµÑ€ÑŒÑ‚Ðµ, Ñ‡Ñ‚Ð¾ Ð¿Ð¾Ñ€Ñ‚Ñ‹ 80 Ð¸ 443 Ð¾Ñ‚ÐºÑ€Ñ‹Ñ‚Ñ‹
sudo ufw status

# ÐŸÑ€Ð¾Ð²ÐµÑ€ÑŒÑ‚Ðµ Ð»Ð¾Ð³Ð¸ Certbot
sudo certbot certificates

# ÐŸÐ¾Ð¿Ñ€Ð¾Ð±ÑƒÐ¹Ñ‚Ðµ Ð²Ñ€ÑƒÑ‡Ð½ÑƒÑŽ
sudo certbot --nginx -d Ð²Ð°Ñˆ-Ð´Ð¾Ð¼ÐµÐ½.ru --debug
```

### ÐŸÑ€Ð¾Ð±Ð»ÐµÐ¼Ð°: Cloudflare Ð½Ðµ Ñ€Ð°Ð±Ð¾Ñ‚Ð°ÐµÑ‚

Ð•ÑÐ»Ð¸ Cloudflare Ð·Ð°Ð±Ð»Ð¾ÐºÐ¸Ñ€Ð¾Ð²Ð°Ð½ Ð¸Ð»Ð¸ Ð¼ÐµÐ´Ð»ÐµÐ½Ð½Ñ‹Ð¹:
1. Ð˜ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÐ¹Ñ‚Ðµ Ð²Ð°Ñ€Ð¸Ð°Ð½Ñ‚ Ñ Let's Encrypt Ð½Ð°Ð¿Ñ€ÑÐ¼ÑƒÑŽ
2. Ð˜Ð»Ð¸ Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÐ¹Ñ‚Ðµ Ñ€Ð¾ÑÑÐ¸Ð¹ÑÐºÐ¸Ð¹ CDN (Yandex CDN)

## ðŸ’¡ Ð ÐµÐºÐ¾Ð¼ÐµÐ½Ð´Ð°Ñ†Ð¸Ð¸ Ð´Ð»Ñ Ð Ð¤/Ð Ð‘

1. **Ð˜ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÐ¹Ñ‚Ðµ Ñ€Ð¾ÑÑÐ¸Ð¹ÑÐºÐ¸Ðµ Ð´Ð¾Ð¼ÐµÐ½Ñ‹** (.ru, .Ñ€Ñ„) - Ð±Ñ‹ÑÑ‚Ñ€ÐµÐµ Ð¸ Ð½Ð°Ð´ÐµÐ¶Ð½ÐµÐµ
2. **Let's Encrypt Ñ€Ð°Ð±Ð¾Ñ‚Ð°ÐµÑ‚ Ð² Ð Ð¤** - Ð¼Ð¾Ð¶Ð½Ð¾ Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÑŒ Ð±ÐµÑÐ¿Ð»Ð°Ñ‚Ð½Ñ‹Ð¹ SSL
3. **Ð¯Ð½Ð´ÐµÐºÑ.ÐžÐ±Ð»Ð°ÐºÐ¾** - Ð»ÑƒÑ‡ÑˆÐ¸Ð¹ Ð²Ñ‹Ð±Ð¾Ñ€ Ð´Ð»Ñ Ñ…Ð¾ÑÑ‚Ð¸Ð½Ð³Ð°
4. **Ð˜Ð·Ð±ÐµÐ³Ð°Ð¹Ñ‚Ðµ Cloudflare** ÐµÑÐ»Ð¸ ÐµÑÑ‚ÑŒ Ð¿Ñ€Ð¾Ð±Ð»ÐµÐ¼Ñ‹ Ñ Ð´Ð¾ÑÑ‚ÑƒÐ¿Ð½Ð¾ÑÑ‚ÑŒÑŽ

## ðŸŽ‰ Ð“Ð¾Ñ‚Ð¾Ð²Ð¾!

ÐŸÐ¾ÑÐ»Ðµ Ð½Ð°ÑÑ‚Ñ€Ð¾Ð¹ÐºÐ¸ Ð²Ð°ÑˆÐµ Ð¿Ñ€Ð¸Ð»Ð¾Ð¶ÐµÐ½Ð¸Ðµ Ð±ÑƒÐ´ÐµÑ‚ Ð´Ð¾ÑÑ‚ÑƒÐ¿Ð½Ð¾:
- ÐšÐ°Ðº Ð²ÐµÐ±-ÑÐ°Ð¹Ñ‚: `https://Ð²Ð°Ñˆ-Ð´Ð¾Ð¼ÐµÐ½.ru`
- ÐšÐ°Ðº Telegram Mini App: Ñ‡ÐµÑ€ÐµÐ· ÐºÐ½Ð¾Ð¿ÐºÑƒ Ð² Ð±Ð¾Ñ‚Ðµ

**Ð’Ð°Ð¶Ð½Ð¾:** Telegram Mini App Ñ‚Ñ€ÐµÐ±ÑƒÐµÑ‚ HTTPS, Ð¿Ð¾ÑÑ‚Ð¾Ð¼Ñƒ SSL Ð¾Ð±ÑÐ·Ð°Ñ‚ÐµÐ»ÐµÐ½!

